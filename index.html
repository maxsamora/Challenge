<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Hack My Heart ‚Äî Maxwell ‚ù§Ô∏è</title>
  <style>
    :root{--accent:#e91e63}
    html,body{height:100%;margin:0;font-family:Inter,Arial,Helvetica,sans-serif}
    /* page backgrounds (images must be in same folder) */
    #terminal{
      height:100vh;
      color:#0f0;
      background: url('bg-terminal.jpg') center/cover no-repeat fixed;
      display:flex;align-items:flex-start;justify-content:flex-start;
      padding:28px;box-sizing:border-box;
      font-family: "Courier New", monospace; white-space:pre-wrap; font-size:1rem;
    }
    #quiz-container{
      display:none;
      min-height:100vh;
      padding:60px 18px;
      box-sizing:border-box;
      background: linear-gradient(rgba(0,0,0,0.45), rgba(0,0,0,0.45)), url('bg-quiz.jpg') center/cover no-repeat fixed;
      color:#fff;
    }
    .panel{
      max-width:820px;margin:28px auto;background:rgba(0,0,0,0.55);padding:22px;border-radius:12px;box-shadow:0 10px 40px rgba(0,0,0,.6);
      color:#fff;
    }
    h1{margin:0 0 8px 0;font-size:1.6rem}
    p.lead{margin:6px 0 18px 0;color:#ddd}
    .q{font-size:1.05rem;margin-bottom:12px}
    input[type="text"]{width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.12);background:rgba(255,255,255,0.03);color:#fff;font-size:1rem}
    button.btn{margin-top:12px;padding:10px 14px;border-radius:8px;background:var(--accent);color:#fff;border:0;font-weight:600;cursor:pointer}
    #feedback{color:#ffbaba;margin-top:8px}
    #final{display:none;text-align:center;padding:40px 20px;background:linear-gradient(rgba(0,0,0,0.45), rgba(0,0,0,0.45)), url('bg-final.jpg') center/cover no-repeat fixed;color:#fff;min-height:60vh}
    #final .card{max-width:720px;margin:40px auto;background:rgba(0,0,0,0.55);padding:24px;border-radius:12px}
    /* hearts canvas sits over everything */
    canvas#hearts{position:fixed;left:0;top:0;width:100%;height:100%;pointer-events:none;z-index:9999}
    /* small unmute button */
    #unmute{
      position:fixed;right:18px;bottom:18px;background:rgba(0,0,0,0.55);color:#fff;padding:10px 12px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);cursor:pointer;display:none;z-index:10000;
    }
    /* responsive tweaks */
    @media (max-width:640px){
      .panel{margin:16px;padding:18px}
      h1{font-size:1.2rem}
    }
  </style>
</head>
<body>
  <!-- audio element: autoplay attempt (muted false) -->
  <audio id="song" src="onedance.mp3" preload="auto" loop></audio>

  <!-- terminal intro -->
  <div id="terminal" aria-hidden="false"></div>

  <!-- quiz container -->
  <div id="quiz-container" aria-hidden="true">
    <div class="panel" id="quiz-panel">
      <h1>üéØ Hack Game</h1>
      <p class="lead">Answer all questions to find out who sent you the flowers üíê</p>

      <div id="quiz">
        <div class="q" id="qtext"></div>
        <input id="answer" type="text" placeholder="type your answer..." autocomplete="off" />
        <div>
          <button class="btn" onclick="check()">Send</button>
        </div>
        <p id="feedback"></p>
      </div>
    </div>
  </div>

  <!-- final screen -->
  <div id="final" aria-hidden="true">
    <div class="card">
      <h1>üíñ You hacked my heart!</h1>
      <p style="font-size:1.05rem;margin:8px 0 18px 0">It was me ‚Äî <strong>Maxwell</strong> üíå</p>
      <p style="margin-bottom:18px">Now you can message me: <a href="https://wa.me/YOURPHONE" style="color:#ffd1dc">message</a></p>
      <p style="font-size:.95rem;color:#ddd">Enjoy the song and the surprise ‚ù§Ô∏è</p>
    </div>
  </div>

  <canvas id="hearts"></canvas>
  <button id="unmute" onclick="unmuteAndPlay()">Unmute / Play</button>

<script>
/* ---------- Opening message + terminal typing ---------- */
const openingMessage = "feliz dia sol√®ne delacourt, que tal jogamos um game para descobrir que e o seu admirador secreto apos voce hackear esse game voce sabera que foi a pessoa que te enviou essas flores";
const introText = [
  openingMessage,
  "",
  "Initializing romantic protocol...",
  "Bypassing firewalls of love...",
  "Decrypting emotions...",
  "Accessing secret feelings...",
  "Connection established: heart_portal",
  "Access granted. Welcome."
];

const terminal = document.getElementById('terminal');
let idxLine = 0;

function typeIntro(){
  if(idxLine < introText.length){
    terminal.textContent += introText[idxLine] + "\n";
    idxLine++;
    const delay = idxLine === 1 ? 1800 : 900;
    setTimeout(typeIntro, delay);
  } else {
    setTimeout(() => {
      // switch screen
      terminal.style.display = 'none';
      document.getElementById('quiz-container').style.display = 'block';
      document.getElementById('quiz-container').setAttribute('aria-hidden','false');
      showQuestion();
    }, 700);
  }
}

/* ---------- Audio autoplay attempt ---------- */
const song = document.getElementById('song');
let audioStarted = false;

// Try to autoplay immediately
function startAudioTry(){
  // try to play - some browsers block this; show unmute button if blocked
  song.volume = 0.7;
  const p = song.play();
  if(p !== undefined){
    p.then(()=>{ audioStarted = true; hideUnmute(); })
     .catch(()=>{ showUnmute(); });
  } else {
    // older browsers
    showUnmute();
  }
}

function showUnmute(){
  const btn = document.getElementById('unmute');
  btn.style.display = 'block';
}

function hideUnmute(){
  document.getElementById('unmute').style.display = 'none';
}

function unmuteAndPlay(){
  song.muted = false;
  song.volume = 0.7;
  song.play().catch(()=>{/* ignore */});
  audioStarted = true;
  hideUnmute();
}

/* ---------- Quiz content (English except Portuguese last answer) ---------- */
const questions = [
  { q: "What is my country of origin?", answers: ["brazil","brasil"] },
  { q: "Where do I live currently?", answers: ["sydney"] },
  { q: "How many siblings do I have?", answers: ["3","three"] },
  { q: "What is my favorite color?", answers: ["red","vermelha"] },
  { q: "What was the first gift you got from me?", answers: ["friends socks","socks friends","meia friends","friends sock"] },
  { q: "What is the color of my body?", answers: ["brown"] },
  { q: "What is the first word that comes to your mind when you think of me?", answers: ["gostoso"] },
  { q: "Which song reminds you of me?", answers: ["one dance","drake one dance"] }
];

let current = 0;

function showQuestion(){
  document.getElementById('qtext').textContent = questions[current].q;
  const ans = document.getElementById('answer');
  ans.value = '';
  ans.focus();
  document.getElementById('feedback').textContent = '';
}

/* normalize helper */
function normalize(str){ return (str||'').trim().toLowerCase(); }

/* check answer & progress */
function check(){
  const user = normalize(document.getElementById('answer').value);
  const valid = questions[current].answers.map(a => a.trim().toLowerCase());
  if(valid.includes(user)){
    current++;
    if(current >= questions.length){
      // success: show final
      document.getElementById('quiz-container').style.display = 'none';
      document.getElementById('final').style.display = 'block';
      document.getElementById('final').setAttribute('aria-hidden','false');
      // start audio if not started
      if(!audioStarted) unmuteAndPlay();
      // confetti/hearts
      launchHearts();
    } else {
      showQuestion();
    }
  } else {
    document.getElementById('feedback').textContent = 'Hmm... try again üòâ';
  }
}

/* ---------- Hearts / confetti ---------- */
function launchHearts(){
  const canvas = document.getElementById('hearts');
  const ctx = canvas.getContext('2d');
  const DPR = window.devicePixelRatio || 1;
  canvas.width = window.innerWidth * DPR;
  canvas.height = window.innerHeight * DPR;
  canvas.style.width = window.innerWidth + 'px';
  canvas.style.height = window.innerHeight + 'px';
  ctx.scale(DPR, DPR);

  const hearts = Array.from({length: 60}).map(()=>({
    x: Math.random()*window.innerWidth,
    y: -Math.random()*window.innerHeight,
    size: Math.random()*22 + 8,
    speed: Math.random()*1.8 + 0.8,
    rot: Math.random()*360,
    color: `hsl(${Math.random()*30 + 330},80%,60%)`
  }));

  function drawHeart(x,y,size,color){
    ctx.save();
    ctx.fillStyle = color;
    ctx.beginPath();
    const top = size * 0.3;
    ctx.moveTo(x, y + top);
    ctx.bezierCurveTo(x, y, x - size/2, y, x - size/2, y + top);
    ctx.bezierCurveTo(x - size/2, y + (size+top)/2, x, y + (size+top)/1.3, x, y + size);
    ctx.bezierCurveTo(x, y + (size+top)/1.3, x + size/2, y + (size+top)/2, x + size/2, y + top);
    ctx.bezierCurveTo(x + size/2, y, x, y, x, y + top);
    ctx.closePath();
    ctx.fill();
    ctx.restore();
  }

  function frame(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    for(const h of hearts){
      drawHeart(h.x, h.y, h.size, h.color);
      h.y += h.speed;
      h.x += Math.sin(h.y/40) * 0.6;
      if(h.y > window.innerHeight + h.size) {
        h.y = -h.size;
        h.x = Math.random()*window.innerWidth;
      }
    }
    requestAnimationFrame(frame);
  }
  frame();
}

/* ---------- kick off ---------- */
startAudioTry();
typeIntro();
</script>
</body>
</html>
